<?init class="org.zkoss.zk.ui.util.Composition" arg0="template.zul" ?>
<zk>
    <window self="@define(content)"
            viewModel="@id('vm') @init('latihan.viewmodel.TicketListViewModel')">

        <vlayout spacing="20px" style="padding:20px;">
            <label value="🎫 Ticket List"
                   style="font-weight:bold; font-size:22px; color:#2c3e50;"/>

            <!-- 🔎 Filter -->
            <hlayout spacing="15px">
                <label value="Filter by Status:" style="font-weight:bold;"/>
                <combobox model="@load(vm.statusOptions)"
                          selectedItem="@bind(vm.selectedStatus)"
                          autodrop="true" readonly="true">
                    <template name="model" var="role">
                        <comboitem label="@load(role.label)" value="@load(role.value)" />
                    </template>
                </combobox>

                <label value="Filter by Priority:" style="font-weight:bold;"/>
                <combobox model="@load(vm.priorityOptions)"
                          selectedItem="@bind(vm.selectedPriority)"
                          autodrop="true" readonly="true">
                    <template name="model" var="role">
                        <comboitem label="@load(role.label)" value="@load(role.value)" />
                    </template>
                </combobox>

                <button label="♻ Reset"
                        onClick="@command('resetFilter')"
                        style="background:#95a5a6; color:white; border-radius:6px;"/>
            </hlayout>

            <!-- 📋 Table Tickets -->
            <groupbox mold="3d" width="100%" style="background:#ffffff; border-radius:10px;">
                <caption label="📌 All Tickets" style="font-weight:bold; color:#2c3e50;"/>
                <listbox model="@bind(vm.filteredTickets)"
                         mold="paging" pageSize="5" width="100%" emptyMessage="No tickets found.">
                    <listhead>
                        <listheader label="ID" width="50px"/>
                        <listheader label="Title"/>
                        <listheader label="Status"/>
                        <listheader label="Priority"/>
                        <listheader label="Assigned To"/>
                        <listheader label="Action" width="120px"/>
                    </listhead>

                    <template name="model" var="t">
                        <listitem>
                            <listcell label="@load(t.id)"/>
                            <listcell label="@load(t.title)"/>
                            <listcell label="@load(vm.getStatusLabel(t.status))"/>
                            <listcell label="@load(vm.getPriorityLabel(t.priority))"/>
                            <listcell label="@load(vm.getAssignedToName(t.assignedTo))"/>
                            <listcell>
                                <button label="🔍 View"
                                        onClick="@command('viewTicket', id=t.id)"
                                        style="background:#3498db; color:white; border-radius:6px;"/>
                            </listcell>
                        </listitem>
                    </template>
                </listbox>
            </groupbox>

            <button label="➕ Create New Ticket" href="ticket_form.zul"
                    style="background:#2ecc71; color:white; border-radius:6px; width:200px;"/>
        </vlayout>
    </window>
</zk>
